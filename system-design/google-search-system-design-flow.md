# Google Search System Design - Complete Flow Diagrams

## ğŸ”„ Complete System Flow

### 1. Web Crawling Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Internet  â”‚
â”‚   Websites  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ URLs to Crawl
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      URL Frontier (Queue)           â”‚
â”‚      (Priority Queue)                â”‚
â”‚                                     â”‚
â”‚  High Priority:                    â”‚
â”‚  â”œâ”€ Popular sites (Wikipedia)      â”‚
â”‚  â”œâ”€ News sites                      â”‚
â”‚  â””â”€ Frequently updated sites       â”‚
â”‚                                     â”‚
â”‚  Medium Priority:                  â”‚
â”‚  â”œâ”€ Regular websites                â”‚
â”‚  â””â”€ Blogs                           â”‚
â”‚                                     â”‚
â”‚  Low Priority:                     â”‚
â”‚  â”œâ”€ Old pages                       â”‚
â”‚  â””â”€ Less important sites           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Dequeue URLs
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Crawler Scheduler              â”‚
â”‚                                     â”‚
â”‚  1. Check robots.txt                â”‚
â”‚     â”œâ”€ Respect crawl-delay          â”‚
â”‚     â”œâ”€ Check allowed/disallowed     â”‚
â”‚     â””â”€ Rate limiting                â”‚
â”‚                                     â”‚
â”‚  2. Check DNS Cache                 â”‚
â”‚     â”œâ”€ Resolve domain to IP         â”‚
â”‚     â””â”€ Cache DNS records            â”‚
â”‚                                     â”‚
â”‚  3. Assign to Crawler Worker        â”‚
â”‚     â”œâ”€ Load balancing               â”‚
â”‚     â””â”€ Geographic distribution      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ HTTP Request
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Crawler Workers                 â”‚
â”‚      (Distributed)                   â”‚
â”‚                                     â”‚
â”‚  Worker 1:                          â”‚
â”‚  â”œâ”€ Fetch: example.com/page1        â”‚
â”‚  â”œâ”€ Parse HTML                      â”‚
â”‚  â”œâ”€ Extract links                   â”‚
â”‚  â””â”€ Extract content                 â”‚
â”‚                                     â”‚
â”‚  Worker 2:                          â”‚
â”‚  â”œâ”€ Fetch: example.com/page2        â”‚
â”‚  â”œâ”€ Parse HTML                      â”‚
â”‚  â”œâ”€ Extract links                   â”‚
â”‚  â””â”€ Extract content                 â”‚
â”‚                                     â”‚
â”‚  Worker N:                          â”‚
â”‚  â””â”€ ...                             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Extracted Data
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Content Processor              â”‚
â”‚                                     â”‚
â”‚  1. Parse HTML                      â”‚
â”‚     â”œâ”€ Extract title                â”‚
â”‚     â”œâ”€ Extract meta description     â”‚
â”‚     â”œâ”€ Extract headings (H1-H6)    â”‚
â”‚     â”œâ”€ Extract body text             â”‚
â”‚     â””â”€ Extract images (alt text)    â”‚
â”‚                                     â”‚
â”‚  2. Extract Links                   â”‚
â”‚     â”œâ”€ Absolute URLs                â”‚
â”‚     â”œâ”€ Relative URLs (resolve)       â”‚
â”‚     â”œâ”€ Filter duplicates            â”‚
â”‚     â””â”€ Add to URL Frontier          â”‚
â”‚                                     â”‚
â”‚  3. Content Normalization            â”‚
â”‚     â”œâ”€ Remove HTML tags             â”‚
â”‚     â”œâ”€ Decode entities              â”‚
â”‚     â””â”€ Clean whitespace              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Processed Content
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      URL Deduplication              â”‚
â”‚                                     â”‚
â”‚  Check if URL already crawled:      â”‚
â”‚  â”œâ”€ Check Bloom Filter (fast)       â”‚
â”‚  â”œâ”€ If maybe exists:                â”‚
â”‚  â”‚   â””â”€ Check Database              â”‚
â”‚  â””â”€ If new: Add to Bloom Filter     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Unique URLs
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Content Storage                 â”‚
â”‚                                     â”‚
â”‚  Store:                             â”‚
â”‚  â”œâ”€ URL                             â”‚
â”‚  â”œâ”€ Content (HTML/text)            â”‚
â”‚  â”œâ”€ Metadata (title, description)   â”‚
â”‚  â”œâ”€ Timestamp                       â”‚
â”‚  â”œâ”€ Links (outgoing)                â”‚
â”‚  â””â”€ Status code                     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Store & Index
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Storage   â”‚    â”‚  Indexing   â”‚
â”‚   (GFS)     â”‚    â”‚   Service   â”‚
â”‚             â”‚    â”‚             â”‚
â”‚  Raw HTML   â”‚    â”‚  Send for   â”‚
â”‚  Content    â”‚    â”‚  indexing   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Crawling Strategy & Politeness

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Crawling Politeness Rules                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  robots.txt Check                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  Example robots.txt:                                    â”‚
â”‚  User-agent: *                                          â”‚
â”‚  Disallow: /private/                                   â”‚
â”‚  Disallow: /admin/                                     â”‚
â”‚  Allow: /public/                                       â”‚
â”‚  Crawl-delay: 1                                         â”‚
â”‚                                                          â”‚
â”‚  Rules Applied:                                         â”‚
â”‚  â”œâ”€ Respect disallowed paths                           â”‚
â”‚  â”œâ”€ Wait crawl-delay seconds                           â”‚
â”‚  â””â”€ Only crawl allowed paths                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Rate Limiting                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  Per Domain Limits:                                     â”‚
â”‚  â”œâ”€ Max requests per second: 1-2                       â”‚
â”‚  â”œâ”€ Max concurrent connections: 1                      â”‚
â”‚  â””â”€ Respect server capacity                            â”‚
â”‚                                                          â”‚
â”‚  Global Limits:                                         â”‚
â”‚  â”œâ”€ Total requests/sec: 10,000+                        â”‚
â”‚  â”œâ”€ Distributed across domains                         â”‚
â”‚  â””â”€ Avoid overwhelming servers                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Crawl Frequency                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  High Frequency (Daily):                              â”‚
â”‚  â”œâ”€ News sites                                         â”‚
â”‚  â”œâ”€ Social media                                       â”‚
â”‚  â””â”€ Frequently updated content                         â”‚
â”‚                                                          â”‚
â”‚  Medium Frequency (Weekly):                            â”‚
â”‚  â”œâ”€ Blogs                                              â”‚
â”‚  â”œâ”€ E-commerce sites                                   â”‚
â”‚  â””â”€ Regular websites                                   â”‚
â”‚                                                          â”‚
â”‚  Low Frequency (Monthly):                               â”‚
â”‚  â”œâ”€ Static sites                                       â”‚
â”‚  â”œâ”€ Old content                                        â”‚
â”‚  â””â”€ Less important pages                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Indexing Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Indexing Pipeline                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Crawled   â”‚
â”‚   Content   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Raw HTML/Text
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Document Parser                 â”‚
â”‚                                     â”‚
â”‚  1. Parse HTML                       â”‚
â”‚     â”œâ”€ Extract structure            â”‚
â”‚     â”œâ”€ Extract text content         â”‚
â”‚     â””â”€ Extract metadata             â”‚
â”‚                                     â”‚
â”‚  2. Language Detection               â”‚
â”‚     â”œâ”€ Detect language (en, hi, etc)â”‚
â”‚     â””â”€ Use for language-specific    â”‚
â”‚        indexing                      â”‚
â”‚                                     â”‚
â”‚  3. Content Extraction               â”‚
â”‚     â”œâ”€ Title                         â”‚
â”‚     â”œâ”€ Meta description             â”‚
â”‚     â”œâ”€ Headings (H1-H6)             â”‚
â”‚     â”œâ”€ Body text                    â”‚
â”‚     â”œâ”€ Alt text (images)            â”‚
â”‚     â””â”€ Links (anchor text)          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Structured Content
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Text Processing                 â”‚
â”‚                                     â”‚
â”‚  1. Tokenization                     â”‚
â”‚     â”œâ”€ Split into words             â”‚
â”‚     â”œâ”€ Handle punctuation           â”‚
â”‚     â””â”€ Preserve positions           â”‚
â”‚                                     â”‚
â”‚  2. Normalization                    â”‚
â”‚     â”œâ”€ Lowercase conversion         â”‚
â”‚     â”œâ”€ Remove accents               â”‚
â”‚     â””â”€ Unicode normalization        â”‚
â”‚                                     â”‚
â”‚  3. Stop Word Removal                â”‚
â”‚     â”œâ”€ Remove common words          â”‚
â”‚     â”‚   (the, a, an, is, etc)        â”‚
â”‚     â””â”€ Keep important terms         â”‚
â”‚                                     â”‚
â”‚  4. Stemming/Lemmatization          â”‚
â”‚     â”œâ”€ running â†’ run                â”‚
â”‚     â”œâ”€ better â†’ good                â”‚
â”‚     â””â”€ Reduce to root form          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Processed Tokens
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Inverted Index Builder          â”‚
â”‚                                     â”‚
â”‚  Input:                              â”‚
â”‚  Document ID: doc123                â”‚
â”‚  Tokens: [search, engine, google]   â”‚
â”‚                                     â”‚
â”‚  Build Inverted Index:              â”‚
â”‚  â”œâ”€ "search" â†’ [doc123, doc456]    â”‚
â”‚  â”œâ”€ "engine" â†’ [doc123, doc789]    â”‚
â”‚  â””â”€ "google" â†’ [doc123]            â”‚
â”‚                                     â”‚
â”‚  Store Additional Info:             â”‚
â”‚  â”œâ”€ Term frequency (TF)             â”‚
â”‚  â”œâ”€ Term positions                  â”‚
â”‚  â”œâ”€ Document frequency (DF)         â”‚
â”‚  â””â”€ Term importance (weight)        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Inverted Index Entries
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Index Storage                    â”‚
â”‚                                     â”‚
â”‚  Sharded by Term:                   â”‚
â”‚  â”œâ”€ Shard 1: a-c                     â”‚
â”‚  â”œâ”€ Shard 2: d-f                     â”‚
â”‚  â”œâ”€ Shard 3: g-i                     â”‚
â”‚  â””â”€ ... (alphabetical)              â”‚
â”‚                                     â”‚
â”‚  Each Shard Contains:               â”‚
â”‚  â”œâ”€ Term â†’ [doc_ids]                â”‚
â”‚  â”œâ”€ TF scores                       â”‚
â”‚  â”œâ”€ Positions                       â”‚
â”‚  â””â”€ Metadata                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Distributed Index
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Index     â”‚    â”‚  Document   â”‚
â”‚   Shards    â”‚    â”‚   Store     â”‚
â”‚             â”‚    â”‚             â”‚
â”‚  Inverted   â”‚    â”‚  Full       â”‚
â”‚  Index      â”‚    â”‚  Documents  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. Inverted Index Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Inverted Index Example                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Term: "search"
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Document List:                                         â”‚
â”‚  â”œâ”€ doc123:                                            â”‚
â”‚  â”‚   â”œâ”€ TF: 5 (appears 5 times)                        â”‚
â”‚  â”‚   â”œâ”€ Positions: [10, 45, 120, 200, 350]           â”‚
â”‚  â”‚   â”œâ”€ Fields: title(1), body(4)                      â”‚
â”‚  â”‚   â””â”€ Weight: 0.8                                    â”‚
â”‚  â”‚                                                     â”‚
â”‚  â”œâ”€ doc456:                                            â”‚
â”‚  â”‚   â”œâ”€ TF: 2                                          â”‚
â”‚  â”‚   â”œâ”€ Positions: [5, 89]                            â”‚
â”‚  â”‚   â”œâ”€ Fields: body(2)                                â”‚
â”‚  â”‚   â””â”€ Weight: 0.3                                    â”‚
â”‚  â”‚                                                     â”‚
â”‚  â””â”€ doc789:                                            â”‚
â”‚      â”œâ”€ TF: 1                                          â”‚
â”‚      â”œâ”€ Positions: [12]                               â”‚
â”‚      â”œâ”€ Fields: body(1)                                â”‚
â”‚      â””â”€ Weight: 0.1                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Term: "engine"
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Document List:                                         â”‚
â”‚  â”œâ”€ doc123:                                            â”‚
â”‚  â”‚   â”œâ”€ TF: 3                                          â”‚
â”‚  â”‚   â”œâ”€ Positions: [11, 46, 121]                      â”‚
â”‚  â”‚   â””â”€ Weight: 0.6                                    â”‚
â”‚  â”‚                                                     â”‚
â”‚  â””â”€ doc456:                                            â”‚
â”‚      â”œâ”€ TF: 1                                          â”‚
â”‚      â”œâ”€ Positions: [90]                              â”‚
â”‚      â””â”€ Weight: 0.2                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Query: "search engine"
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Intersection:                                         â”‚
â”‚  â”œâ”€ "search" â†’ [doc123, doc456, doc789]                â”‚
â”‚  â”œâ”€ "engine" â†’ [doc123, doc456]                        â”‚
â”‚  â””â”€ Result: [doc123, doc456] (both terms present)      â”‚
â”‚                                                          â”‚
â”‚  Ranking:                                              â”‚
â”‚  â”œâ”€ doc123: Higher score (both terms, high TF)        â”‚
â”‚  â””â”€ doc456: Lower score (both terms, lower TF)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. Ranking Algorithm Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Search Query Processing                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User      â”‚
â”‚   Query     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ "best restaurants in Mumbai"
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Query Parser                    â”‚
â”‚                                     â”‚
â”‚  1. Tokenization                     â”‚
â”‚     â”œâ”€ Split into words              â”‚
â”‚     â””â”€ ["best", "restaurants",       â”‚
â”‚         "in", "Mumbai"]              â”‚
â”‚                                     â”‚
â”‚  2. Stop Word Removal                â”‚
â”‚     â”œâ”€ Remove "in"                   â”‚
â”‚     â””â”€ ["best", "restaurants",       â”‚
â”‚         "Mumbai"]                    â”‚
â”‚                                     â”‚
â”‚  3. Query Understanding              â”‚
â”‚     â”œâ”€ Intent: Local search         â”‚
â”‚     â”œâ”€ Entity: Mumbai (location)    â”‚
â”‚     â””â”€ Type: Restaurants            â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Processed Query
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Index Lookup                    â”‚
â”‚                                     â”‚
â”‚  For each term:                     â”‚
â”‚  â”œâ”€ "best" â†’ [doc1, doc2, doc3]    â”‚
â”‚  â”œâ”€ "restaurants" â†’ [doc2, doc4]   â”‚
â”‚  â””â”€ "Mumbai" â†’ [doc2, doc5]        â”‚
â”‚                                     â”‚
â”‚  Intersection:                      â”‚
â”‚  â””â”€ doc2 (contains all terms)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Candidate Documents
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Ranking Algorithm                                  â”‚
â”‚      (PageRank + TF-IDF + Signals)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Component 1: TF-IDF Score                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  TF (Term Frequency):                                   â”‚
â”‚  â”œâ”€ How often term appears in document                  â”‚
â”‚  â”œâ”€ Higher TF = More relevant                          â”‚
â”‚  â””â”€ Formula: TF = count(term) / total_words            â”‚
â”‚                                                          â”‚
â”‚  IDF (Inverse Document Frequency):                      â”‚
â”‚  â”œâ”€ How rare the term is across all documents          â”‚
â”‚  â”œâ”€ Rare terms = Higher weight                        â”‚
â”‚  â””â”€ Formula: IDF = log(total_docs / docs_with_term)    â”‚
â”‚                                                          â”‚
â”‚  TF-IDF Score:                                          â”‚
â”‚  â””â”€ TF Ã— IDF                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Component 2: PageRank Score                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  PageRank Algorithm:                                    â”‚
â”‚  â”œâ”€ Based on link graph                                â”‚
â”‚  â”œâ”€ Pages with more backlinks = Higher rank            â”‚
â”‚  â”œâ”€ Quality of backlinks matters                      â”‚
â”‚  â””â”€ Recursive calculation                              â”‚
â”‚                                                          â”‚
â”‚  Formula:                                               â”‚
â”‚  PR(A) = (1-d) + d Ã— Î£(PR(B)/L(B))                    â”‚
â”‚                                                          â”‚
â”‚  Where:                                                 â”‚
â”‚  â”œâ”€ PR(A) = PageRank of page A                        â”‚
â”‚  â”œâ”€ d = Damping factor (0.85)                         â”‚
â”‚  â”œâ”€ PR(B) = PageRank of linking pages                  â”‚
â”‚  â””â”€ L(B) = Number of outbound links from B            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Component 3: Additional Signals                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  Content Signals:                                       â”‚
â”‚  â”œâ”€ Title match (higher weight)                       â”‚
â”‚  â”œâ”€ Heading match (H1-H6)                              â”‚
â”‚  â”œâ”€ Meta description match                             â”‚
â”‚  â”œâ”€ URL structure                                       â”‚
â”‚  â””â”€ Content freshness                                   â”‚
â”‚                                                          â”‚
â”‚  User Behavior Signals:                                 â”‚
â”‚  â”œâ”€ Click-through rate (CTR)                           â”‚
â”‚  â”œâ”€ Dwell time (time on page)                         â”‚
â”‚  â”œâ”€ Bounce rate                                         â”‚
â”‚  â””â”€ User location (for local results)                  â”‚
â”‚                                                          â”‚
â”‚  Technical Signals:                                     â”‚
â”‚  â”œâ”€ Page load speed                                     â”‚
â”‚  â”œâ”€ Mobile-friendliness                                â”‚
â”‚  â”œâ”€ HTTPS (security)                                    â”‚
â”‚  â””â”€ Structured data (schema.org)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Final Ranking Score                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  Score = w1 Ã— TF-IDF +                                  â”‚
â”‚          w2 Ã— PageRank +                                 â”‚
â”‚          w3 Ã— Content Signals +                         â”‚
â”‚          w4 Ã— User Behavior +                           â”‚
â”‚          w5 Ã— Technical Signals                         â”‚
â”‚                                                          â”‚
â”‚  Where w1-w5 are weights (learned from ML)            â”‚
â”‚                                                          â”‚
â”‚  Sort documents by score (descending)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Ranked Results
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Result Formatting               â”‚
â”‚                                     â”‚
â”‚  For each result:                   â”‚
â”‚  â”œâ”€ Title                           â”‚
â”‚  â”œâ”€ URL                             â”‚
â”‚  â”œâ”€ Snippet (description)           â”‚
â”‚  â”œâ”€ Rich snippets (if available)   â”‚
â”‚  â””â”€ Additional info (date, etc)     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Formatted Results
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User      â”‚
â”‚   Sees      â”‚
â”‚   Results   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6. PageRank Calculation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    PageRank Algorithm                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Initial State:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Page A    â”‚â”€â”€â”€â–¶â”‚   Page B    â”‚â”€â”€â”€â–¶â”‚   Page C    â”‚
â”‚   PR: 1.0   â”‚    â”‚   PR: 1.0   â”‚    â”‚   PR: 1.0   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                  â”‚
       â”‚                  â”‚                  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚   Page D    â”‚
                   â”‚   PR: 1.0   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Iteration 1:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PR(A) = 0.15 + 0.85 Ã— (PR(B)/2 + PR(C)/1)            â”‚
â”‚  PR(B) = 0.15 + 0.85 Ã— (PR(A)/1 + PR(D)/1)            â”‚
â”‚  PR(C) = 0.15 + 0.85 Ã— (PR(B)/2)                      â”‚
â”‚  PR(D) = 0.15 + 0.85 Ã— (PR(B)/2 + PR(C)/1)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

After Multiple Iterations (Convergence):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Page A    â”‚â”€â”€â”€â–¶â”‚   Page B    â”‚â”€â”€â”€â–¶â”‚   Page C    â”‚
â”‚   PR: 1.49  â”‚    â”‚   PR: 1.58  â”‚    â”‚   PR: 0.78  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                  â”‚
       â”‚                  â”‚                  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚   Page D    â”‚
                   â”‚   PR: 1.15  â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Final Ranking:
1. Page B (PR: 1.58) - Most backlinks
2. Page A (PR: 1.49) - Good backlinks
3. Page D (PR: 1.15) - Some backlinks
4. Page C (PR: 0.78) - Fewer backlinks
```

### 7. Search Query Flow (Complete)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User      â”‚
â”‚  (Browser)  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ GET /search?q=best+restaurants+Mumbai
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Load Balancer                  â”‚
â”‚      (Google Frontend)               â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚
       â”‚ Route            â”‚ Route
       â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Query       â”‚    â”‚ Query       â”‚
â”‚ Server 1    â”‚    â”‚ Server 2    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚
       â”‚ Query Processing
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Query Understanding             â”‚
â”‚                                     â”‚
â”‚  1. Parse Query                      â”‚
â”‚     â”œâ”€ Extract terms                 â”‚
â”‚     â”œâ”€ Detect intent                 â”‚
â”‚     â””â”€ Identify entities             â”‚
â”‚                                     â”‚
â”‚  2. Query Expansion                  â”‚
â”‚     â”œâ”€ Synonyms                      â”‚
â”‚     â”œâ”€ Related terms                  â”‚
â”‚     â””â”€ Spelling corrections          â”‚
â”‚                                     â”‚
â”‚  3. Personalization                  â”‚
â”‚     â”œâ”€ User location                 â”‚
â”‚     â”œâ”€ Search history                â”‚
â”‚     â””â”€ Preferences                   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Processed Query
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Index Lookup                    â”‚
â”‚                                     â”‚
â”‚  For each term:                     â”‚
â”‚  â”œâ”€ Lookup in inverted index        â”‚
â”‚  â”œâ”€ Get document lists              â”‚
â”‚  â””â”€ Intersect lists                 â”‚
â”‚                                     â”‚
â”‚  Result: Candidate documents        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Candidate Docs
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Ranking Service                 â”‚
â”‚                                     â”‚
â”‚  For each candidate:                â”‚
â”‚  â”œâ”€ Calculate TF-IDF score          â”‚
â”‚  â”œâ”€ Get PageRank score              â”‚
â”‚  â”œâ”€ Calculate signal scores         â”‚
â”‚  â””â”€ Combine scores                  â”‚
â”‚                                     â”‚
â”‚  Sort by final score                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Ranked Results
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Result Enhancement             â”‚
â”‚                                     â”‚
â”‚  1. Rich Snippets                   â”‚
â”‚     â”œâ”€ Extract structured data      â”‚
â”‚     â”œâ”€ Ratings, reviews             â”‚
â”‚     â””â”€ Images, videos               â”‚
â”‚                                     â”‚
â”‚  2. Featured Snippets               â”‚
â”‚     â”œâ”€ Answer extraction            â”‚
â”‚     â””â”€ Direct answers               â”‚
â”‚                                     â”‚
â”‚  3. Knowledge Graph                 â”‚
â”‚     â”œâ”€ Entity information           â”‚
â”‚     â””â”€ Related entities             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Enhanced Results
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User      â”‚
â”‚  Sees       â”‚
â”‚  Results    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8. Scale Estimation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Capacity Estimation                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Assumptions:
â”œâ”€ 8 billion web pages indexed
â”œâ”€ 100 billion searches per day
â”œâ”€ Average query: 3 words
â”œâ”€ Average document size: 50 KB
â””â”€ Peak traffic: 10x average

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Storage Requirements                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  Raw Content Storage:                                   â”‚
â”‚  â”œâ”€ 8B pages Ã— 50 KB = 400 TB                          â”‚
â”‚  â”œâ”€ With compression: ~100 TB                          â”‚
â”‚  â””â”€ With replication (3x): ~300 TB                     â”‚
â”‚                                                          â”‚
â”‚  Index Storage:                                         â”‚
â”‚  â”œâ”€ Inverted index: ~50 TB                              â”‚
â”‚  â”œâ”€ PageRank scores: ~64 GB (8B Ã— 8 bytes)            â”‚
â”‚  â”œâ”€ Metadata: ~20 TB                                    â”‚
â”‚  â””â”€ Total Index: ~70 TB                                 â”‚
â”‚                                                          â”‚
â”‚  Total Storage: ~370 TB                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Query Throughput                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  Average Load:                                          â”‚
â”‚  â”œâ”€ 100B queries/day = 1.16M queries/sec                â”‚
â”‚  â””â”€ Peak: 11.6M queries/sec                             â”‚
â”‚                                                          â”‚
â”‚  Per Query Processing:                                  â”‚
â”‚  â”œâ”€ Index lookup: ~10ms                                 â”‚
â”‚  â”œâ”€ Ranking: ~50ms                                      â”‚
â”‚  â”œâ”€ Result formatting: ~10ms                           â”‚
â”‚  â””â”€ Total: ~70ms per query                             â”‚
â”‚                                                          â”‚
â”‚  Required Servers:                                       â”‚
â”‚  â”œâ”€ Average: 1.16M Ã— 0.07s = 81K servers               â”‚
â”‚  â””â”€ Peak: 11.6M Ã— 0.07s = 812K servers                â”‚
â”‚     (with caching, actual: ~10K servers)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Crawling Capacity                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  Crawl Rate:                                            â”‚
â”‚  â”œâ”€ 8B pages to crawl                                  â”‚
â”‚  â”œâ”€ Average refresh: 30 days                            â”‚
â”‚  â”œâ”€ Pages per day: 8B / 30 = 267M pages/day           â”‚
â”‚  â””â”€ Pages per second: ~3,000 pages/sec                 â”‚
â”‚                                                          â”‚
â”‚  Crawler Infrastructure:                                â”‚
â”‚  â”œâ”€ Crawler workers: ~10,000                            â”‚
â”‚  â”œâ”€ Each worker: ~0.3 pages/sec                        â”‚
â”‚  â””â”€ Total capacity: ~3,000 pages/sec                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Network Bandwidth                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  Crawling Bandwidth:                                    â”‚
â”‚  â”œâ”€ 3,000 pages/sec Ã— 50 KB = 150 MB/s                â”‚
â”‚  â””â”€ Peak: ~1.5 GB/s                                    â”‚
â”‚                                                          â”‚
â”‚  Query Bandwidth:                                       â”‚
â”‚  â”œâ”€ 1.16M queries/sec Ã— 1 KB = 1.16 GB/s              â”‚
â”‚  â”œâ”€ Response: 1.16M Ã— 10 KB = 11.6 GB/s               â”‚
â”‚  â””â”€ Peak: ~116 GB/s                                    â”‚
â”‚                                                          â”‚
â”‚  Total Bandwidth: ~120 GB/s                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9. Distributed Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    System Architecture                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend Layer                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Load       â”‚  â”‚ Load       â”‚  â”‚ Load       â”‚    â”‚
â”‚  â”‚ Balancer 1 â”‚  â”‚ Balancer 2 â”‚  â”‚ Balancer N â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                â”‚                â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                        â”‚                               â”‚
â”‚                        â–¼                               â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚         â”‚  Query Servers           â”‚                  â”‚
â”‚         â”‚  (10,000+ instances)     â”‚                  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Index Layer                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  Index Shards (by term):                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ Shard 1  â”‚  â”‚ Shard 2  â”‚  â”‚ Shard N  â”‚            â”‚
â”‚  â”‚ (a-c)    â”‚  â”‚ (d-f)    â”‚  â”‚ (x-z)    â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â”‚
â”‚       â”‚             â”‚             â”‚                    â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                    â”‚                                   â”‚
â”‚                    â–¼                                   â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚         â”‚  Index Servers           â”‚                  â”‚
â”‚         â”‚  (1,000+ instances)      â”‚                  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Storage Layer                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Storage    â”‚  â”‚ Storage    â”‚  â”‚ Storage    â”‚    â”‚
â”‚  â”‚ Cluster 1  â”‚  â”‚ Cluster 2  â”‚  â”‚ Cluster N  â”‚    â”‚
â”‚  â”‚            â”‚  â”‚            â”‚  â”‚            â”‚    â”‚
â”‚  â”‚ GFS        â”‚  â”‚ GFS        â”‚  â”‚ GFS        â”‚    â”‚
â”‚  â”‚ (300 TB)   â”‚  â”‚ (300 TB)   â”‚  â”‚ (300 TB)   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                          â”‚
â”‚  Replication: 3x (for redundancy)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Crawling Layer                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Crawler    â”‚  â”‚ Crawler    â”‚  â”‚ Crawler    â”‚    â”‚
â”‚  â”‚ Worker 1   â”‚  â”‚ Worker 2   â”‚  â”‚ Worker N   â”‚    â”‚
â”‚  â”‚            â”‚  â”‚            â”‚  â”‚            â”‚    â”‚
â”‚  â”‚ 0.3        â”‚  â”‚ 0.3        â”‚  â”‚ 0.3        â”‚    â”‚
â”‚  â”‚ pages/sec  â”‚  â”‚ pages/sec  â”‚  â”‚ pages/sec  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                          â”‚
â”‚  Total: 10,000 workers Ã— 0.3 = 3,000 pages/sec         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10. Caching Strategy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Multi-Level Caching                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Level 1: Browser Cache
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User's Browser                                         â”‚
â”‚  â”œâ”€ Cache common queries                                â”‚
â”‚  â”œâ”€ Cache autocomplete suggestions                      â”‚
â”‚  â””â”€ TTL: 1 hour                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ Cache Miss
              â–¼
Level 2: CDN Cache
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Edge Servers (Global)                                  â”‚
â”‚  â”œâ”€ Cache popular queries                               â”‚
â”‚  â”œâ”€ Geographic distribution                             â”‚
â”‚  â””â”€ TTL: 5 minutes                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ Cache Miss
              â–¼
Level 3: Application Cache
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Query Server Cache (Redis/Memcached)                  â”‚
â”‚  â”œâ”€ Cache query results                                 â”‚
â”‚  â”œâ”€ Cache index lookups                                 â”‚
â”‚  â””â”€ TTL: 1 minute                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ Cache Miss
              â–¼
Level 4: Index Cache
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Index Server Cache                                     â”‚
â”‚  â”œâ”€ Cache inverted index entries                       â”‚
â”‚  â”œâ”€ Cache PageRank scores                               â”‚
â”‚  â””â”€ TTL: 10 minutes                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ Cache Miss
              â–¼
Level 5: Database/Storage
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Persistent Storage                                     â”‚
â”‚  â”œâ”€ Full index                                          â”‚
â”‚  â”œâ”€ Document store                                      â”‚
â”‚  â””â”€ Always available                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Cache Hit Rates:
â”œâ”€ Level 1 (Browser): ~30%
â”œâ”€ Level 2 (CDN): ~50%
â”œâ”€ Level 3 (Application): ~80%
â”œâ”€ Level 4 (Index): ~90%
â””â”€ Overall: ~95% cache hit rate
```

### 11. Index Update Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Incremental Index Updates                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Crawler   â”‚
â”‚   Discovers â”‚
â”‚   Updated   â”‚
â”‚   Page      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Page Changed
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Content Comparison              â”‚
â”‚                                     â”‚
â”‚  1. Fetch new content               â”‚
â”‚  2. Compare with old content        â”‚
â”‚  3. Calculate diff                  â”‚
â”‚  4. Determine if re-index needed    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Changes Detected
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Incremental Index Update       â”‚
â”‚                                     â”‚
â”‚  1. Remove old index entries        â”‚
â”‚     â”œâ”€ Remove term â†’ doc mappings   â”‚
â”‚     â””â”€ Update term frequencies      â”‚
â”‚                                     â”‚
â”‚  2. Add new index entries            â”‚
â”‚     â”œâ”€ Add new term â†’ doc mappings  â”‚
â”‚     â””â”€ Update term frequencies      â”‚
â”‚                                     â”‚
â”‚  3. Update PageRank                  â”‚
â”‚     â”œâ”€ Recalculate if links changedâ”‚
â”‚     â””â”€ Update scores                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Updated Index
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Index Propagation               â”‚
â”‚                                     â”‚
â”‚  1. Update primary index             â”‚
â”‚  2. Propagate to replicas            â”‚
â”‚  3. Update cache                     â”‚
â”‚  4. Make live                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 12. Query Processing Timeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Query Processing Timeline                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Time: 0ms    â”Œâ”€ User types query
             â”‚
Time: 50ms   â”œâ”€ Autocomplete suggestions (if typing)
             â”‚
Time: 200ms  â”œâ”€ User presses Enter
             â”‚
Time: 201ms  â”œâ”€ Request sent to Google servers
             â”‚
Time: 210ms  â”œâ”€ Load balancer routes request
             â”‚
Time: 220ms  â”œâ”€ Query server receives request
             â”‚
Time: 230ms  â”œâ”€ Check cache (Level 3)
             â”‚  â”œâ”€ Cache HIT: Return (50ms total)
             â”‚  â””â”€ Cache MISS: Continue
             â”‚
Time: 250ms  â”œâ”€ Query parsing & understanding
             â”‚
Time: 260ms  â”œâ”€ Index lookup (parallel)
             â”‚  â”œâ”€ Lookup term 1: 10ms
             â”‚  â”œâ”€ Lookup term 2: 10ms
             â”‚  â””â”€ Lookup term 3: 10ms
             â”‚
Time: 280ms  â”œâ”€ Document intersection
             â”‚
Time: 300ms  â”œâ”€ Ranking calculation
             â”‚  â”œâ”€ TF-IDF: 20ms
             â”‚  â”œâ”€ PageRank: 10ms
             â”‚  â””â”€ Signals: 20ms
             â”‚
Time: 350ms  â”œâ”€ Result enhancement
             â”‚  â”œâ”€ Rich snippets: 10ms
             â”‚  â””â”€ Knowledge graph: 10ms
             â”‚
Time: 370ms  â”œâ”€ Result formatting
             â”‚
Time: 380ms  â”œâ”€ Response sent to user
             â”‚
Time: 400ms  â””â”€ User sees results

Total: ~400ms (cache miss)
Total: ~50ms (cache hit)
```

---

## ğŸ“ Key Takeaways

1. **Web Crawling**:
   - Distributed crawlers with rate limiting
   - Respect robots.txt and crawl-delay
   - URL frontier with priority queue
   - Bloom filters for deduplication

2. **Indexing**:
   - Inverted index for fast lookups
   - Sharded by terms (alphabetical)
   - TF-IDF for relevance scoring
   - Incremental updates for efficiency

3. **Ranking Algorithm**:
   - Combines multiple signals:
     - TF-IDF (content relevance)
     - PageRank (link authority)
     - User behavior (CTR, dwell time)
     - Technical signals (speed, mobile-friendly)
   - Machine learning for weight optimization

4. **Scale Estimation**:
   - 8 billion pages indexed
   - 100 billion queries/day
   - 1.16M queries/sec (average)
   - 11.6M queries/sec (peak)
   - Multi-level caching (95% hit rate)

5. **Architecture**:
   - Distributed system with sharding
   - Horizontal scaling
   - Redundancy and replication
   - Low latency (< 400ms)

---

*Complete flow diagrams for Google Search system design - ready for implementation!*
